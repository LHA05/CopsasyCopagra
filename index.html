<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Inicio</title>
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">
    <link href="css/sb-admin-2.min.css" rel="stylesheet">

</head>

<body>
    <style>
        sw-main {
            position: relative;
            display: block;
            margin: 0;
            padding: 0;
            border-radius: .25rem !important
        }

        .sw-main .sw-container {
            display: block;
            margin: 0;
            padding: 0;
            position: relative
        }

        .sw-main .step-content {
            display: none;
            position: relative;
            margin: 0
        }

        .sw-main .sw-toolbar {
            margin-left: 0
        }

        .sw-theme-default {
            -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, .3);
            box-shadow: 0 1px 3px rgba(0, 0, 0, .3)
        }

        .sw-theme-default .sw-container {
            min-height: 250px
        }

        .sw-theme-default .step-content {
            padding: 10px;
            border: 0 solid #d4d4d4;
            background-color: #fff;
            text-align: left
        }

        .sw-theme-default .sw-toolbar {
            background: #f9f9f9;
            border-radius: 0 !important;
            padding-left: 10px;
            padding-right: 10px;
            padding: 10px;
            margin-bottom: 0 !important
        }

        .sw-theme-default .sw-toolbar-top {
            border-bottom-color: #ddd !important
        }

        .sw-theme-default .sw-toolbar-bottom {
            border-top-color: #ddd !important
        }

        .sw-theme-default>ul.step-anchor>li {
            position: relative;
            margin-right: 2px
        }

        .sw-theme-default>ul.step-anchor>li>a,
        .sw-theme-default>ul.step-anchor>li>a:hover {
            border: none !important;
            color: #bbb;
            text-decoration: none;
            outline-style: none;
            background: 0 0 !important;
            border: none !important;
            cursor: not-allowed
        }

        .sw-theme-default>ul.step-anchor>li.clickable>a:hover {
            color: #4285f4 !important;
            background: 0 0 !important;
            cursor: pointer
        }

        .sw-theme-default>ul.step-anchor>li>a::after {
            content: "";
            background: #4285f4;
            height: 2px;
            position: absolute;
            width: 100%;
            left: 0;
            bottom: 0;
            -webkit-transition: all 250ms ease 0s;
            transition: all 250ms ease 0s;
            -webkit-transform: scale(0);
            -ms-transform: scale(0);
            transform: scale(0)
        }

        .sw-theme-default>ul.step-anchor>li.active>a {
            border: none !important;
            color: #4285f4 !important;
            background: 0 0 !important;
            cursor: pointer
        }

        .sw-theme-default>ul.step-anchor>li.active>a::after {
            -webkit-transform: scale(1);
            -ms-transform: scale(1);
            transform: scale(1)
        }

        .sw-theme-default>ul.step-anchor>li.done>a {
            border: none !important;
            color: #000 !important;
            background: 0 0 !important;
            cursor: pointer
        }

        .sw-theme-default>ul.step-anchor>li.done>a::after {
            background: #5cb85c;
            -webkit-transform: scale(1);
            -ms-transform: scale(1);
            transform: scale(1)
        }

        .sw-theme-default>ul.step-anchor>li.danger>a {
            border: none !important;
            color: #d9534f !important;
            cursor: pointer
        }

        .sw-theme-default>ul.step-anchor>li.danger>a::after {
            background: #d9534f;
            border-left-color: #f8d7da;
            -webkit-transform: scale(1);
            -ms-transform: scale(1);
            transform: scale(1)
        }

        .sw-theme-default>ul.step-anchor>li.disabled>a,
        .sw-theme-default>ul.step-anchor>li.disabled>a:hover {
            color: #eee !important;
            cursor: not-allowed
        }

        @media screen and (max-width:768px) {
            .sw-theme-default>.nav-tabs>li {
                float: none !important
            }
        }

        .sw-loading::after {
            position: absolute;
            display: block;
            opacity: 1;
            content: "";
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: rgba(255, 255, 255, .7);
            -webkit-transition: all .2s ease;
            transition: all .2s ease;
            z-index: 2
        }

        .sw-loading::before {
            content: '';
            display: inline-block;
            position: absolute;
            top: 50%;
            left: 50%;
            z-index: 10;
            border: 10px solid #f3f3f3;
            border-radius: 50%;
            border-top: 10px solid #3498db;
            width: 80px;
            height: 80px;
            margin-top: -40px;
            margin-left: -40px;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0)
            }

            100% {
                -webkit-transform: rotate(360deg)
            }
        }

        @keyframes spin {
            0% {
                -webkit-transform: rotate(0);
                transform: rotate(0)
            }

            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg)
            }
        }

        .sw-theme-arrows {
            border-radius: 5px;
        }

        .sw-theme-arrows>.sw-container {
            min-height: 200px
        }

        .sw-theme-arrows .step-content {
            padding: 0 10px;
            border: 0 solid #d4d4d4;
        }

        .sw-theme-arrows .sw-toolbar {
            padding: 10px;
            margin-bottom: 0 !important
        }

        .sw-theme-arrows>ul.step-anchor {
            border: 0;
            padding: 0;
            border-radius: 0;
            border-top-right-radius: 5px;
            list-style: none;
            overflow: hidden
        }

        .sw-theme-arrows>ul.step-anchor li+li:before {
            padding: 0
        }

        .sw-theme-arrows>ul.step-anchor>li>a,
        .sw-theme-arrows>ul.step-anchor>li>a:hover {
            color: #bbb;
            text-decoration: none;
            padding: 10px 0 10px 45px;
            position: relative;
            display: block;
            border: 0 !important;
            border-radius: 0;
            outline-style: none;
            background: #f5f5f5
        }

        .sw-theme-arrows>ul.step-anchor>li>a:after {
            content: " ";
            display: block;
            width: 0;
            height: 0;
            border-top: 50px solid transparent;
            border-bottom: 50px solid transparent;
            border-left: 30px solid #f5f5f5;
            position: absolute;
            top: 50%;
            margin-top: -50px;
            left: 100%;
            z-index: 2
        }

        .sw-theme-arrows>ul.step-anchor>li>a:before {
            content: " ";
            display: block;
            width: 0;
            height: 0;
            border-top: 50px solid transparent;
            border-bottom: 50px solid transparent;
            border-left: 30px solid #ddd;
            position: absolute;
            top: 50%;
            margin-top: -50px;
            margin-left: 1px;
            left: 100%;
            z-index: 1
        }

        .sw-theme-arrows>ul.step-anchor>li:first-child>a {
            padding-left: 15px
        }

        .sw-theme-arrows>ul.step-anchor>li>a:hover {
            color: #bbb;
            text-decoration: none;
            outline-style: none;
            background: #f5f5f5;
            border-color: #f5f5f5
        }

        .sw-theme-arrows>ul.step-anchor>li>a:hover:after {
            border-left-color: #f5f5f5
        }

        .sw-theme-arrows>ul.step-anchor>li.clickable>a:hover {
            color: #4285f4 !important;
            background: #46b8da !important
        }

        .sw-theme-arrows>ul.step-anchor>li.active>a {
            border-color: #32348b !important;
            color: #fff !important;
            background: #32348b !important
        }

        .sw-theme-arrows>ul.step-anchor>li.active>a:after {
            border-left: 30px solid #32348b !important
        }

        .sw-theme-arrows>ul.step-anchor>li.done>a {
            border-color: #8081e2 !important;
            color: #fff !important;
            background: #8081e2 !important
        }

        .sw-theme-arrows>ul.step-anchor>li.done>a:after {
            border-left: 30px solid #8081e2
        }

        .sw-theme-arrows>ul.step-anchor>li.danger>a {
            border-color: #d9534f !important;
            color: #fff !important;
            background: #d9534f !important
        }

        .sw-theme-arrows>ul.step-anchor>li.danger>a:after {
            border-left: 30px solid #d9534f !important
        }

        .sw-theme-arrows>ul.step-anchor>li.disabled>a,
        .sw-theme-arrows>ul.step-anchor>li.disabled>a:hover {
            color: #eee !important
        }

        @media screen and (max-width:768px) {
            .sw-theme-arrows>ul.step-anchor {
                border: 0;
                background: #ddd !important
            }

            .sw-theme-arrows>.nav-tabs>li {
                float: none !important;
                margin-bottom: 0
            }

            .sw-theme-arrows>ul.step-anchor>li>a,
            .sw-theme-arrows>ul.step-anchor>li>a:hover {
                padding-left: 15px;
                margin-right: 0;
                margin-bottom: 1px
            }

            .sw-theme-arrows>ul.step-anchor>li>a:after,
            .sw-theme-arrows>ul.step-anchor>li>a:before {
                display: none
            }
        }

        .sw-theme-arrows::before {
            border: 10px solid #f3f3f3;
            border-top: 10px solid #5cb85c
        }
    </style>
    <div id="wrapper">
        <ul class="navbar-nav  sidebar sidebar-dark accordion" id="accordionSidebar">
            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                <div class="sidebar-brand-icon">
                    <img src="img/logo.png" style="width: 80px; height: 70px; vertical-align: middle;">
                </div>
                <div class="sidebar-brand-text mx-3">COPSA Y COPAGRA</div>
            </a>
            <!-- Nav Item - Dashboard -->
            <li class="nav-item">
                <a class="nav-link" href="index.html">
                    <img src="img/autobus.png" style="width: 25px; height: 20px; vertical-align: middle;">
                    <span>Autobuses</span></a>
            </li>
            <!-- Divider -->
            <hr class="sidebar-divider">
            <!-- Heading -->
            <div class="sidebar-heading">

            </div>
            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <img src="img/reporte.png" style="width: 25px; height: 20px; vertical-align: middle;">
                    <span>Reportes</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="buttons.html">Fallas Reportadas</a>
                        <a class="collapse-item" href="cards.html">Reporte de Fallas</a>
                        <a class="collapse-item" href="utilities-animation.html">Reporte de Operadores</a>
                        <a class="collapse-item" href="utilities-other.html">Reporte de Mecanicos</a>
                    </div>
                </div>
            </li>
            <!-- Nav Item - Utilities Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities"
                    aria-expanded="true" aria-controls="collapseUtilities">
                    <img src="img/trabajo.png" style="width: 25px; height: 20px; vertical-align: middle;">
                    <span>Trabajo</span>
                </a>
                <div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="utilities-color.html">Orden de Trabajo</a>
                        <a class="collapse-item" href="utilities-border.html">Generar Orden de Trabajo</a>
                    </div>
                </div>
            </li>
            <!-- Divider -->
            <hr class="sidebar-divider">
            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapsePages"
                    aria-expanded="true" aria-controls="collapsePages">
                    <img src="img/km.png" style="width: 25px; height: 20px; vertical-align: middle;">
                    <span>KM y Insumos</span>
                </a>
                <div id="collapsePages" class="collapse" aria-labelledby="headingPages" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="404.html">KM y Insumos</a>
                        <a class="collapse-item" href="blank.html">Almacen</a>
                    </div>
                </div>
            </li>
            <!-- Nav Item - Charts -->
            <li class="nav-item">
                <a class="nav-link" href="charts.html">
                    <img src="img/grafica.png" style="width: 25px; height: 20px; vertical-align: middle;">
                    <span>Dashboard</span></a>
            </li>
            <!-- Divider -->
            <hr class="sidebar-divider d-none d-md-block">
            <!-- Sidebar Toggler (Sidebar) -->
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>
        </ul>
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
                    <!-- Sidebar Toggle (Topbar) -->
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>
                    <!-- Topbar Search -->
                    <form
                        class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
                        <div class="input-group">
                            <input type="text" class="form-control bg-light border-0 small" placeholder="Buscar"
                                aria-label="Search" aria-describedby="basic-addon2">
                            <div class="input-group-append">
                                <button class="btn btn-primary" type="button">
                                    <i class="fas fa-search fa-sm"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                    <!-- Topbar Navbar -->
                    <ul class="navbar-nav ml-auto">
                        <!-- Nav Item - Search Dropdown (Visible Only XS) -->
                        <li class="nav-item dropdown no-arrow d-sm-none">
                            <a class="nav-link dropdown-toggle" href="#" id="searchDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-search fa-fw"></i>
                            </a>
                            <!-- Dropdown - Messages -->
                            <div class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in"
                                aria-labelledby="searchDropdown">
                                <form class="form-inline mr-auto w-100 navbar-search">
                                    <div class="input-group">
                                        <input type="text" class="form-control bg-light border-0 small"
                                            placeholder="Search for..." aria-label="Search"
                                            aria-describedby="basic-addon2">
                                        <div class="input-group-append">
                                            <button class="btn btn-primary" type="button">
                                                <i class="fas fa-search fa-sm"></i>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </li>
                        <div class="topbar-divider d-none d-sm-block"></div>
                        <!-- Nav Item - User Information -->
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="mr-2 d-none d-lg-inline text-gray-600 small">Mantenimiento</span>
                                <img class="img-profile rounded-circle" src="img/profile.png">
                            </a>
                            <!-- Dropdown - User Information -->
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="userDropdown">
                                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                    Salir
                                </a>
                            </div>
                        </li>
                    </ul>
                </nav>

        <!-- Formulario para subir datos de usuario -->
        <div class="container mt-5 p-4">
            <form id="formUsuario" method="post" action="../../models/insert.php" enctype="multipart/form-data">
                <input type="hidden" name="form_type" value="usuario">
                <div class="container p-4">
                    <h2 class="text-center">Autobuses</h2>
                    <div id="smartwizard">
                        <ul class="nav nav-pills justify-content-center flex-wrap flex-md-nowrap">
                            <li class="nav-item" ><a href="#step-1"
                                    class="nav-link">Paso 1<br><small>Datos Personales</small></a></li>
                            <li class="nav-item"><a href="#step-2" class="nav-link">Paso 2<br><small>Datos
                                        Profesionales</small></a></li>
                            <li class="nav-item"><a href="#step-3" class="nav-link">Paso 3<br><small>Correo y
                                        Contraseña</small></a></li>
                           
                        </ul>
                        <div class="mt-4">
                            <!-- Paso 1: Datos Personales -->
                            <div id="step-1" class="step-content" style="display: block;">
                                <div class="row">
                                    <div class="col-sm-12 col-md-4 mt-3">
                                        <label for="usuario_nombre" class="form-label">Económico:</label>
                                        <input type="text" id="usuario_nombre" name="usuario_nombre"
                                            class="form-control" required>
                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                    </div>
                                    <div class="col-sm-12 col-md-4 mt-3">
                                        <label for="usuario_apellido_p" class="form-label">Modelo:</label>
                                        <input type="text" id="usuario_apellido_p" name="usuario_apellido_p"
                                            class="form-control" required>
                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                    </div>
                                    <div class="col-sm-12 col-md-4 mt-3">
                                        <label for="usuario_apellido_m" class="form-label">Serie/Folio:</label>
                                        <input type="text" id="usuario_apellido_m" name="usuario_apellido_m"
                                            class="form-control" required>
                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                    </div>
                                </div>

                              
                            </div>

                            <!-- Paso 2: Datos Profesionales -->
                            <div id="step-2" class="step-content" style="display: none;">
                                <div class="row">
                                    <div class="col-sm-12 col-md-4 mt-3">
                                        <label for="numero_empleado" class="form-label">NIV:</label>
                                        <input type="text" id="numero_empleado" name="numero_empleado"
                                            class="form-control" required>
                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                    </div>
                                    <div class="col-sm-12 col-md-4 mt-3">
                                        <label for="grado_academico" class="form-label">Motor:</label>
                                        <input type="text" id="grado_academico" name="grado_academico"
                                            class="form-control" required>
                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                    </div>
                                    <div class="col-sm-12 col-md-4 mt-3">
                                        <label for="cedula" class="form-label">Transmisión:</label>
                                        <input type="text" id="cedula" name="cedula" class="form-control" required>
                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                    </div>
                                </div>           
                            </div>

                            <!-- Paso 3: Correo y Contraseña -->
                            <div id="step-3" class="step-content" style="display: none;">
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 mt-3">
                                        <label for="correo" class="form-label">Marca:</label>
<input type="text" id="usuario_apellido_p" name="usuario_apellido_p"
                                            class="form-control" required>                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                    </div>
                                    <div class="col-sm-12 col-md-6 mt-3">
                                        <label for="correo" class="form-label">Tipo:</label>
                                        <input type="tipo_auto" id="tipo_auto" name="tipo_auto" class="form-control" required>
                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                    </div>
                                    <div class="col-sm-12 col-md-6 mt-3">
                                        <label for="tipo_usuario_tipo_usuario_id" class="form-label">Estatus:</label>
                                        <select id="tipo_usuario_tipo_usuario_id" name="tipo_usuario_tipo_usuario_id"
                                            class="form-control" required>
                                            <option value="" disabled selected>Seleccione un tipo de usuario</option>
                                            <?php foreach ($tiposUsuario as $tipo): ?>
                                            <option value="<?php echo $tipo['tipo_usuario_id']; ?>">
                                                <?php echo htmlspecialchars($tipo['descripcion']); ?>
                                            </option>
                                            <?php endforeach; ?>
                                        </select>
                                        <div class="invalid-feedback">Este campo no puede estar vacío.</div>
                                        <div class="row mt-3">
                                            <div class="col-md-12 text-center">
                                            
                                            </div>                                            
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-center">

                                    <button type="submit" class="btn btn-success btn-lg " style="background-color: #32348b; border: none;">Registrar</button>
                                </div>
                            </div>

                           
                             

                        </div>
            </form>
        </div>
    </div>
    </div>
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="js/sb-admin-2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/smart_wizard.min.js"></script>
    <script>
        // Previsualiza la imagen seleccionada
        function previewImage() {
            const fileInput = document.getElementById('fileInput');
            const imagePreview = document.getElementById('imagePreview');

            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        }

        $(document).ready(function () {
            // Inicializa el wizard
            $('#smartwizard').smartWizard({
                selected: 0, // Inicia en el primer paso (índice 0)
                theme: 'arrows',
                autoAdjustHeight: true,
                transitionEffect: 'fade',
                showStepURLhash: false,
                toolbarSettings: {
                    toolbarPosition: 'bottom',
                    showNextButton: true,
                    showPreviousButton: true
                },
            });

            // Validación al cambiar de paso
            $('#smartwizard').on("leaveStep", function (e, anchorObject, stepNumber, stepDirection) {
                if (stepDirection === 'forward' && !validateStep($("#step-" + (stepNumber + 1)))) {
                    return false; // Cancela el avance si hay errores
                }
                return true; // Si no hay errores, continúa
            });


            // Función de validación para cada paso
            function validateStep(step) {
                let isValid = true;
                $(step).find('input, select').each(function () {
                    let value = $(this).val().trim();
                    $(this).val(value); // Actualiza el valor sin espacios

                    // Verifica la validez del campo
                    if (!this.checkValidity() || value === "") {
                        $(this).addClass('is-invalid');
                        isValid = false;
                    } else {
                        $(this).removeClass('is-invalid');
                    }

                    // Validación específica para el campo de contraseña
                    if ($(this).attr('type') === 'password') {
                        if (value.length < 8) {
                            $(this).addClass('is-invalid');
                            $(this).get(0).setCustomValidity('La contraseña debe tener al menos 8 caracteres.');
                            isValid = false;
                        } else {
                            $(this).removeClass('is-invalid');
                            $(this).get(0).setCustomValidity(''); // Resetea el mensaje de error
                        }
                    }

                    // Validación de la edad
                    if ($(this).attr('id') === 'edad') {
                        const ageNum = parseInt(value, 10);
                        if (isNaN(ageNum) || ageNum < 18 || ageNum > 90) {
                            $(this).addClass('is-invalid');
                            $(this).get(0).setCustomValidity('La edad debe estar entre 18 y 90 años.');
                            isValid = false;
                        } else {
                            $(this).removeClass('is-invalid');
                            $(this).get(0).setCustomValidity(''); // Resetea el mensaje de error
                        }
                    }
                });
                return isValid;
            }


            // Validación de contraseñas
            document.getElementById('password').addEventListener('input', function () {
                const password = this.value.trim();
                if (password.length < 8) {
                    this.setCustomValidity('La contraseña debe tener al menos 8 caracteres.');
                    $(this).addClass('is-invalid');
                } else {
                    this.setCustomValidity('');
                    $(this).removeClass('is-invalid');
                }
            });

            document.getElementById('confirm_password').addEventListener('input', function () {
                const password = document.getElementById('password').value.trim();
                const confirmPassword = this.value.trim();
                if (password !== confirmPassword) {
                    this.setCustomValidity('Las contraseñas deben coincidir.');
                    $(this).addClass('is-invalid');
                } else {
                    this.setCustomValidity('');
                    $(this).removeClass('is-invalid');
                }
            });

            // Filtra caracteres no permitidos
            $('#usuario_nombre, #usuario_apellido_p, #usuario_apellido_m, #grado_academico').on('input', function () {
                this.value = this.value.replace(/[^A-Za-z\s]/g, ''); // Solo permite letras y espacios
            });

            // Validación de la edad
            function isValidAge(age) {
                const ageNum = parseInt(age, 10);
                return !isNaN(ageNum) && ageNum >= 18 && ageNum <= 90; // Cambié 89 por 90
            }

            // Función para enviar el formulario
            $('#formUsuario').on('submit', function (event) {
                event.preventDefault(); // Previene el envío del formulario

                const nombre = $('#usuario_nombre').val();
                const apellidoP = $('#usuario_apellido_p').val();
                const apellidoM = $('#usuario_apellido_m').val();
                const edad = $('#edad').val();
                const gradoAcademico = $('#grado_academico').val();
                const cedula = $('#cedula').val();
                const password = $('#password').val();

                // Validar campos vacíos o solo espacios
                if ([nombre, apellidoP, apellidoM, gradoAcademico, cedula].some(containsOnlySpaces)) {
                    showAlert('Error', 'Los campos no pueden estar vacíos o contener solo espacios.', 'error');
                    return; // No envía el formulario si hay campos inválidos
                }

                // Validar la edad
                if (!isValidAge(edad)) {
                    showAlert('Error', 'La edad debe ser un número entre 18 y 90 años.', 'error'); // Cambié 89 por 90
                    return; // No envía el formulario si la edad es inválida
                }

                // Validar la contraseña
                if (!isValidPassword(password)) {
                    showAlert('Error', 'La contraseña debe tener al menos 8 caracteres.', 'error');
                    return; // No envía el formulario si la contraseña es inválida
                }

                this.submit(); // Envía el formulario
                checkForMessages(); // Comprueba mensajes después de enviar
            });

            // Verifica y muestra mensajes de éxito o error
            function checkForMessages() {
                const urlParams = new URLSearchParams(window.location.search);
                const success = urlParams.get('success');
                const error = urlParams.get('error');

                if (success === 'true') {
                    showAlert('¡Éxito!', 'Usuario registrado con éxito.', 'success');
                } else if (error) {
                    let errorMessage = {
                        'upload': 'Error al subir la imagen.',
                        'duplicate': 'Este usuario ya está registrado.'
                    }[error] || 'Ocurrió un error inesperado. Intenta nuevamente.';

                    showAlert('Error', errorMessage, 'error');
                }
            }

            // Muestra alertas usando SweetAlert
            function showAlert(title, text, icon) {
                Swal.fire({
                    title: title,
                    text: text,
                    icon: icon,
                    confirmButtonText: 'Aceptar'
                });
            }

            // Verifica los mensajes al cargar la página
            checkForMessages();
        });

        // Función para verificar si el campo contiene solo espacios
        function containsOnlySpaces(value) {
            return value.trim() === '';
        }

        // Función para validar la contraseña
        function isValidPassword(password) {
            return password.length >= 8; // Verifica que la contraseña tenga al menos 8 caracteres
        }
    </script>

    <script>
        !(function (t, s, e, n) {
            "use strict";
            function i(s, e) {
                (this.options = t.extend(!0, {}, o, e)),
                    (this.main = t(s)),
                    (this.nav = this.main.children("ul")),
                    (this.steps = t("li > a", this.nav)),
                    (this.container = this.main.children("div")),
                    (this.pages = this.container.children("div")),
                    (this.current_index = null),
                    (this.options.toolbarSettings.toolbarButtonPosition =
                        "right" === this.options.toolbarSettings.toolbarButtonPosition
                            ? "end"
                            : this.options.toolbarSettings.toolbarButtonPosition),
                    (this.options.toolbarSettings.toolbarButtonPosition =
                        "left" === this.options.toolbarSettings.toolbarButtonPosition
                            ? "start"
                            : this.options.toolbarSettings.toolbarButtonPosition),
                    (this.options.theme =
                        null === this.options.theme || "" === this.options.theme
                            ? "default"
                            : this.options.theme),
                    this.init();
            }
            var o = {
                selected: 0,
                keyNavigation: !0,
                autoAdjustHeight: !0,
                cycleSteps: !1,
                backButtonSupport: !0,
                useURLhash: !0,
                showStepURLhash: !0,
                lang: { next: "Siguiente", previous: "Anterior" },
                toolbarSettings: {
                    toolbarPosition: "bottom",
                    toolbarButtonPosition: "end",
                    showNextButton: !0,
                    showPreviousButton: !0,
                    toolbarExtraButtons: [],
                },
                anchorSettings: {
                    anchorClickable: !0,
                    enableAllAnchors: !1,
                    markDoneStep: !0,
                    markAllPreviousStepsAsDone: !0,
                    removeDoneStepOnNavigateBack: !1,
                    enableAnchorOnDoneStep: !0,
                },
                contentURL: null,
                contentCache: !0,
                ajaxSettings: {},
                disabledSteps: [],
                errorSteps: [],
                hiddenSteps: [],
                theme: "default",
                transitionEffect: "none",
                transitionSpeed: "400",
            };
            t.extend(i.prototype, {
                init: function () {
                    this._setElements(), this._setToolbar(), this._setEvents();
                    var e = this.options.selected;
                    if (this.options.useURLhash) {
                        var n = s.location.hash;
                        if (n && n.length > 0) {
                            var i = t("a[href*='" + n + "']", this.nav);
                            if (i.length > 0) {
                                var o = this.steps.index(i);
                                e = o >= 0 ? o : e;
                            }
                        }
                    }
                    e > 0 &&
                        this.options.anchorSettings.markDoneStep &&
                        this.options.anchorSettings.markAllPreviousStepsAsDone &&
                        this.steps.eq(e).parent("li").prevAll().addClass("done"),
                        this._showStep(e);
                },
                _setElements: function () {
                    this.main.addClass("sw-main sw-theme-" + this.options.theme),
                        this.nav
                            .addClass("nav nav-tabs step-anchor")
                            .children("li")
                            .addClass("nav-item")
                            .children("a")
                            .addClass("nav-link"),
                        this.options.anchorSettings.enableAllAnchors !== !1 &&
                        this.options.anchorSettings.anchorClickable !== !1 &&
                        this.steps.parent("li").addClass("clickable"),
                        this.container.addClass("sw-container tab-content"),
                        this.pages.addClass("tab-pane step-content");
                    var s = this;
                    return (
                        this.options.disabledSteps &&
                        this.options.disabledSteps.length > 0 &&
                        t.each(this.options.disabledSteps, function (t, e) {
                            s.steps.eq(e).parent("li").addClass("disabled");
                        }),
                        this.options.errorSteps &&
                        this.options.errorSteps.length > 0 &&
                        t.each(this.options.errorSteps, function (t, e) {
                            s.steps.eq(e).parent("li").addClass("danger");
                        }),
                        this.options.hiddenSteps &&
                        this.options.hiddenSteps.length > 0 &&
                        t.each(this.options.hiddenSteps, function (t, e) {
                            s.steps.eq(e).parent("li").addClass("hidden");
                        }),
                        !0
                    );
                },
                _setToolbar: function () {
                    if ("none" === this.options.toolbarSettings.toolbarPosition) return !0;
                    var s =
                        this.options.toolbarSettings.showNextButton !== !1
                            ? t("<button></button>")
                                .text(this.options.lang.next)
                                .addClass("btn btn-secondary sw-btn-next")
                                .attr("type", "button")
                            : null,
                        e =
                            this.options.toolbarSettings.showPreviousButton !== !1
                                ? t("<button></button>")
                                    .text(this.options.lang.previous)
                                    .addClass("btn btn-secondary sw-btn-prev")
                                    .attr("type", "button")
                                : null,
                        n = t("<div></div>")
                            .addClass("btn-group mr-2 sw-btn-group")
                            .attr("role", "group")
                            .append(e, s),
                        i = null;
                    this.options.toolbarSettings.toolbarExtraButtons &&
                        this.options.toolbarSettings.toolbarExtraButtons.length > 0 &&
                        ((i = t("<div></div>")
                            .addClass("btn-group mr-2 sw-btn-group-extra")
                            .attr("role", "group")),
                            t.each(
                                this.options.toolbarSettings.toolbarExtraButtons,
                                function (t, s) {
                                    i.append(s.clone(!0));
                                }
                            ));
                    var o, a;
                    switch (this.options.toolbarSettings.toolbarPosition) {
                        case "top":
                            (o = t("<div></div>").addClass(
                                "btn-toolbar sw-toolbar sw-toolbar-top justify-content-" +
                                this.options.toolbarSettings.toolbarButtonPosition
                            )),
                                o.append(n),
                                "start" === this.options.toolbarSettings.toolbarButtonPosition
                                    ? o.prepend(i)
                                    : o.append(i),
                                this.container.before(o);
                            break;
                        case "bottom":
                            (a = t("<div></div>").addClass(
                                "btn-toolbar sw-toolbar sw-toolbar-bottom justify-content-" +
                                this.options.toolbarSettings.toolbarButtonPosition
                            )),
                                a.append(n),
                                "start" === this.options.toolbarSettings.toolbarButtonPosition
                                    ? a.prepend(i)
                                    : a.append(i),
                                this.container.after(a);
                            break;
                        case "both":
                            (o = t("<div></div>").addClass(
                                "btn-toolbar sw-toolbar sw-toolbar-top justify-content-" +
                                this.options.toolbarSettings.toolbarButtonPosition
                            )),
                                o.append(n),
                                "start" === this.options.toolbarSettings.toolbarButtonPosition
                                    ? o.prepend(i)
                                    : o.append(i),
                                this.container.before(o),
                                (a = t("<div></div>").addClass(
                                    "btn-toolbar sw-toolbar sw-toolbar-bottom justify-content-" +
                                    this.options.toolbarSettings.toolbarButtonPosition
                                )),
                                a.append(n.clone(!0)),
                                null !== i &&
                                ("start" === this.options.toolbarSettings.toolbarButtonPosition
                                    ? a.prepend(i.clone(!0))
                                    : a.append(i.clone(!0))),
                                this.container.after(a);
                            break;
                        default:
                            (a = t("<div></div>").addClass(
                                "btn-toolbar sw-toolbar sw-toolbar-bottom justify-content-" +
                                this.options.toolbarSettings.toolbarButtonPosition
                            )),
                                a.append(n),
                                this.options.toolbarSettings.toolbarButtonPosition,
                                a.append(i),
                                this.container.after(a);
                    }
                    return !0;
                },
                _setEvents: function () {
                    var n = this;
                    return (
                        t(this.steps).on("click", function (t) {
                            if (
                                (t.preventDefault(),
                                    n.options.anchorSettings.anchorClickable === !1)
                            )
                                return !0;
                            var s = n.steps.index(this);
                            if (
                                n.options.anchorSettings.enableAnchorOnDoneStep === !1 &&
                                n.steps.eq(s).parent("li").hasClass("done")
                            )
                                return !0;
                            s !== n.current_index &&
                                (n.options.anchorSettings.enableAllAnchors !== !1 &&
                                    n.options.anchorSettings.anchorClickable !== !1
                                    ? n._showStep(s)
                                    : n.steps.eq(s).parent("li").hasClass("done") && n._showStep(s));
                        }),
                        t(".sw-btn-next", this.main).on("click", function (t) {
                            t.preventDefault(), n._showNext();
                        }),
                        t(".sw-btn-prev", this.main).on("click", function (t) {
                            t.preventDefault(), n._showPrevious();
                        }),
                        this.options.keyNavigation &&
                        t(e).keyup(function (t) {
                            n._keyNav(t);
                        }),
                        this.options.backButtonSupport &&
                        t(s).on("hashchange", function (e) {
                            if (!n.options.useURLhash) return !0;
                            if (s.location.hash) {
                                var i = t("a[href*='" + s.location.hash + "']", n.nav);
                                i &&
                                    i.length > 0 &&
                                    (e.preventDefault(), n._showStep(n.steps.index(i)));
                            }
                        }),
                        !0
                    );
                },
                _showNext: function () {
                    for (var t = this.current_index + 1, s = t; s < this.steps.length; s++)
                        if (
                            !this.steps.eq(s).parent("li").hasClass("disabled") &&
                            !this.steps.eq(s).parent("li").hasClass("hidden")
                        ) {
                            t = s;
                            break;
                        }
                    if (this.steps.length <= t) {
                        if (!this.options.cycleSteps) return !1;
                        t = 0;
                    }
                    return this._showStep(t), !0;
                },
                _showPrevious: function () {
                    for (var t = this.current_index - 1, s = t; s >= 0; s--)
                        if (
                            !this.steps.eq(s).parent("li").hasClass("disabled") &&
                            !this.steps.eq(s).parent("li").hasClass("hidden")
                        ) {
                            t = s;
                            break;
                        }
                    if (0 > t) {
                        if (!this.options.cycleSteps) return !1;
                        t = this.steps.length - 1;
                    }
                    return this._showStep(t), !0;
                },
                _showStep: function (t) {
                    return (
                        !!this.steps.eq(t) &&
                        t != this.current_index &&
                        !this.steps.eq(t).parent("li").hasClass("disabled") &&
                        !this.steps.eq(t).parent("li").hasClass("hidden") &&
                        (this._loadStepContent(t), !0)
                    );
                },
                _loadStepContent: function (s) {
                    var e = this,
                        n = this.steps.eq(this.current_index),
                        i = "",
                        o = this.steps.eq(s),
                        a =
                            o.data("content-url") && o.data("content-url").length > 0
                                ? o.data("content-url")
                                : this.options.contentURL;
                    if (
                        (null !== this.current_index &&
                            this.current_index !== s &&
                            (i = this.current_index < s ? "forward" : "backward"),
                            null !== this.current_index &&
                            this._triggerEvent("leaveStep", [n, this.current_index, i]) === !1)
                    )
                        return !1;
                    if (
                        !(a && a.length > 0) ||
                        (o.data("has-content") && this.options.contentCache)
                    )
                        this._transitPage(s);
                    else {
                        var r = o.length > 0 ? t(o.attr("href"), this.main) : null,
                            h = t.extend(
                                !0,
                                {},
                                {
                                    url: a,
                                    type: "POST",
                                    data: { step_number: s },
                                    dataType: "text",
                                    beforeSend: function () {
                                        e._loader("show");
                                    },
                                    error: function (s, n, i) {
                                        e._loader("hide"), t.error(i);
                                    },
                                    success: function (t) {
                                        t && t.length > 0 && (o.data("has-content", !0), r.html(t)),
                                            e._loader("hide"),
                                            e._transitPage(s);
                                    },
                                },
                                this.options.ajaxSettings
                            );
                        t.ajax(h);
                    }
                    return !0;
                },
                _transitPage: function (s) {
                    var e = this,
                        n = this.steps.eq(this.current_index),
                        i = n.length > 0 ? t(n.attr("href"), this.main) : null,
                        o = this.steps.eq(s),
                        a = o.length > 0 ? t(o.attr("href"), this.main) : null,
                        r = "";
                    null !== this.current_index &&
                        this.current_index !== s &&
                        (r = this.current_index < s ? "forward" : "backward");
                    var h = "middle";
                    return (
                        0 === s ? (h = "first") : s === this.steps.length - 1 && (h = "final"),
                        (this.options.transitionEffect =
                            this.options.transitionEffect.toLowerCase()),
                        this.pages.finish(),
                        "slide" === this.options.transitionEffect
                            ? i && i.length > 0
                                ? i.slideUp("fast", this.options.transitionEasing, function () {
                                    a.slideDown(
                                        e.options.transitionSpeed,
                                        e.options.transitionEasing
                                    );
                                })
                                : a.slideDown(
                                    this.options.transitionSpeed,
                                    this.options.transitionEasing
                                )
                            : "fade" === this.options.transitionEffect
                                ? i && i.length > 0
                                    ? i.fadeOut("fast", this.options.transitionEasing, function () {
                                        a.fadeIn("fast", e.options.transitionEasing, function () {
                                            t(this).show();
                                        });
                                    })
                                    : a.fadeIn(
                                        this.options.transitionSpeed,
                                        this.options.transitionEasing,
                                        function () {
                                            t(this).show();
                                        }
                                    )
                                : (i && i.length > 0 && i.hide(), a.show()),
                        this._setURLHash(o.attr("href")),
                        this._setAnchor(s),
                        this._setButtons(s),
                        this._fixHeight(s),
                        (this.current_index = s),
                        this._triggerEvent("showStep", [o, this.current_index, r, h]),
                        !0
                    );
                },
                _setAnchor: function (t) {
                    return (
                        this.steps.eq(this.current_index).parent("li").removeClass("active"),
                        this.options.anchorSettings.markDoneStep !== !1 &&
                        null !== this.current_index &&
                        (this.steps.eq(this.current_index).parent("li").addClass("done"),
                            this.options.anchorSettings.removeDoneStepOnNavigateBack !== !1 &&
                            this.steps.eq(t).parent("li").nextAll().removeClass("done")),
                        this.steps.eq(t).parent("li").removeClass("done").addClass("active"),
                        !0
                    );
                },
                _setButtons: function (s) {
                    return (
                        this.options.cycleSteps ||
                        (0 >= s
                            ? t(".sw-btn-prev", this.main).addClass("disabled")
                            : t(".sw-btn-prev", this.main).removeClass("disabled"),
                            this.steps.length - 1 <= s
                                ? t(".sw-btn-next", this.main).addClass("disabled")
                                : t(".sw-btn-next", this.main).removeClass("disabled")),
                        !0
                    );
                },
                _keyNav: function (t) {
                    var s = this;
                    switch (t.which) {
                        case 37:
                            s._showPrevious(), t.preventDefault();
                            break;
                        case 39:
                            s._showNext(), t.preventDefault();
                            break;
                        default:
                            return;
                    }
                },
                _fixHeight: function (s) {
                    if (this.options.autoAdjustHeight) {
                        var e =
                            this.steps.eq(s).length > 0
                                ? t(this.steps.eq(s).attr("href"), this.main)
                                : null;
                        this.container
                            .finish()
                            .animate(
                                { minHeight: e.outerHeight() },
                                this.options.transitionSpeed,
                                function () { }
                            );
                    }
                    return !0;
                },
                _triggerEvent: function (s, e) {
                    var n = t.Event(s);
                    return this.main.trigger(n, e), !n.isDefaultPrevented() && n.result;
                },
                _setURLHash: function (t) {
                    this.options.showStepURLhash &&
                        s.location.hash !== t &&
                        (s.location.hash = t);
                },
                _loader: function (t) {
                    switch (t) {
                        case "show":
                            this.main.addClass("sw-loading");
                            break;
                        case "hide":
                            this.main.removeClass("sw-loading");
                            break;
                        default:
                            this.main.toggleClass("sw-loading");
                    }
                },
                theme: function (t) {
                    if (this.options.theme === t) return !1;
                    this.main.removeClass("sw-theme-" + this.options.theme),
                        (this.options.theme = t),
                        this.main.addClass("sw-theme-" + this.options.theme),
                        this._triggerEvent("themeChanged", [this.options.theme]);
                },
                next: function () {
                    this._showNext();
                },
                prev: function () {
                    this._showPrevious();
                },
                reset: function () {
                    if (this._triggerEvent("beginReset") === !1) return !1;
                    this.container.stop(!0),
                        this.pages.stop(!0),
                        this.pages.hide(),
                        (this.current_index = null),
                        this._setURLHash(this.steps.eq(this.options.selected).attr("href")),
                        t(".sw-toolbar", this.main).remove(),
                        this.steps.removeClass(),
                        this.steps.parents("li").removeClass(),
                        this.steps.data("has-content", !1),
                        this.init(),
                        this._triggerEvent("endReset");
                },
                stepState: function (s, e) {
                    s = t.isArray(s) ? s : [s];
                    var n = t.grep(this.steps, function (e, n) {
                        return t.inArray(n, s) !== -1;
                    });
                    if (n && n.length > 0)
                        switch (e) {
                            case "disable":
                                t(n).parents("li").addClass("disabled");
                                break;
                            case "enable":
                                t(n).parents("li").removeClass("disabled");
                                break;
                            case "hide":
                                t(n).parents("li").addClass("hidden");
                                break;
                            case "show":
                                t(n).parents("li").removeClass("hidden");
                                break;
                            case "error-on":
                                t(n).parents("li").addClass("danger");
                                break;
                            case "error-off":
                                t(n).parents("li").removeClass("danger");
                        }
                },
            }),
                (t.fn.smartWizard = function (s) {
                    var e,
                        n = arguments;
                    return void 0 === s || "object" == typeof s
                        ? this.each(function () {
                            t.data(this, "smartWizard") ||
                                t.data(this, "smartWizard", new i(this, s));
                        })
                        : "string" == typeof s && "_" !== s[0] && "init" !== s
                            ? ((e = t.data(this[0], "smartWizard")),
                                "destroy" === s && t.data(this, "smartWizard", null),
                                e instanceof i && "function" == typeof e[s]
                                    ? e[s].apply(e, Array.prototype.slice.call(n, 1))
                                    : this)
                            : void 0;
                });
        })(jQuery, window, document);
    </script>
</body>

</html>